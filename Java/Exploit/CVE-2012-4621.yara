rule Exploit_Java_CVE_2012_4621_2147679193_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Java/CVE-2012-4621"
        threat_id = "2147679193"
        type = "Exploit"
        platform = "Java: Java binaries (classes)"
        family = "CVE-2012-4621"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "30"
        strings_accuracy = "Low"
    strings:
        $x_5_1 = "java/io/FileOutputStream" ascii //weight: 5
        $x_5_2 = "java/lang/reflect/Field" ascii //weight: 5
        $x_5_3 = "java/security/cert/Certificate;" ascii //weight: 5
        $x_5_4 = "java/net/URL" ascii //weight: 5
        $x_2_5 = {2f 73 65 63 75 72 69 74 79 2f 50 72 6f 74 65 63 74 69 6f 6e 44 6f 6d 61 69 6e [0-16] 61 63 63 65 73 73 [0-16] 47 65 74 43 6c 61 73 73}  //weight: 2, accuracy: Low
        $x_2_6 = "SetField" ascii //weight: 2
        $x_2_7 = "tmpdir" ascii //weight: 2
        $x_1_8 = ".tmp" ascii //weight: 1
        $x_1_9 = "http://" ascii //weight: 1
        $x_2_10 = {2e 70 68 70 [0-16] 3f 77 68 6f 6c 65 3d}  //weight: 2, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

