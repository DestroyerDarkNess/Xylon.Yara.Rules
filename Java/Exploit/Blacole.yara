rule Exploit_Java_Blacole_GD_2147658683_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Java/Blacole.GD"
        threat_id = "2147658683"
        type = "Exploit"
        platform = "Java: Java binaries (classes)"
        family = "Blacole"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {05 bd 3a 19 03 2b 53 19 04 2c 53 bb 59 2a b2 ?? 32 b8 b7 b2 ?? 32 b8 19 b7 3a 19 b6 2a 19 b7 3a 19 2d 19 b6 b1}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Exploit_Java_Blacole_GN_2147664801_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Java/Blacole.GN"
        threat_id = "2147664801"
        type = "Exploit"
        platform = "Java: Java binaries (classes)"
        family = "Blacole"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "11"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {3a 09 19 09 [0-23] 03 [0-23] 33 [0-23] 10 4d a0 (01|00) ?? [0-23] 19 09 [0-23] 04 [0-23] 33 [0-23] 10 5a a0 00}  //weight: 1, accuracy: Low
        $x_1_2 = {3a 0a 19 0a [0-23] 03 [0-23] 33 [0-23] 10 4d a0 (01|00) ?? [0-23] 19 0a [0-23] 04 [0-23] 33 [0-23] 10 5a a0 00}  //weight: 1, accuracy: Low
        $x_1_3 = {3a 09 19 09 [0-23] 04 [0-23] 33 [0-23] 10 5a a0 (01|00) ?? [0-23] 19 09 [0-23] 03 [0-23] 33 [0-23] 10 4d a0 00}  //weight: 1, accuracy: Low
        $x_1_4 = {10 4d a0 00 10 00 2a [0-23] b4 00 ?? [0-23] 03 [0-23] 33 [0-23] 10 4d a0 00 ?? [0-23] 2a [0-23] b4 00 ?? [0-23] 04 [0-23] 33 [0-23] 10 5a a0 00}  //weight: 1, accuracy: Low
        $x_10_5 = {a7 00 04 bf}  //weight: 10, accuracy: High
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_10_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Exploit_Java_Blacole_GP_2147665248_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Java/Blacole.GP"
        threat_id = "2147665248"
        type = "Exploit"
        platform = "Java: Java binaries (classes)"
        family = "Blacole"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {13 13 b8 57 a7 4c 2a 13 b6 2a 13 b6 b8 bb 59 b7 4c 03 3d a7 2b 01 b6 57 84 1c 13 a1 14 b8 a7 4d 2a b6 b6 4d 2b 2c b6 4e 2d b8 a7 4c b1}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Exploit_Java_Blacole_GP_2147665248_1
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Java/Blacole.GP"
        threat_id = "2147665248"
        type = "Exploit"
        platform = "Java: Java binaries (classes)"
        family = "Blacole"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {3a 08 11 10 00 bc 08 3a 09 (03|2a 10 06 b6 ?? ??)}  //weight: 1, accuracy: Low
        $x_1_2 = {10 41 10 5a b6 ?? ?? 36 04 [0-42] 10 41 a1 ff}  //weight: 1, accuracy: Low
        $x_1_3 = {19 b6 19 b6 bb 59 13 b7 19 b6 13 b6 2b b6 b6 3a b8 19 b6 57}  //weight: 1, accuracy: High
        $x_1_4 = {a7 00 04 bf}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule Exploit_Java_Blacole_AHN_2147665294_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Java/Blacole.AHN"
        threat_id = "2147665294"
        type = "Exploit"
        platform = "Java: Java binaries (classes)"
        family = "Blacole"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "21"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {bb 59 bb 59 2a [0-2] 2b b7 (2c|19) b7 b0}  //weight: 1, accuracy: Low
        $x_1_2 = {bb 59 bb 59 bb 59 b2 (10|04) 32 b8 b7 03 bd b7 2a b7 b0}  //weight: 1, accuracy: Low
        $x_1_3 = {bb 59 bb 59 bb 59 b2 (03|2d|06) 32 b8 b7 2c b7 2d b7 3a 2a b2 (06|05|04) 32 2b 03 2b be 19 b6 3a 19 b6 57 a7 4c b1}  //weight: 1, accuracy: Low
        $x_1_4 = {bb 59 bb 59 bb 59 19 b7 2c b7 2d b7 3a 2a b2 (03|2d|08|10) 32 2b 03 2b be 19 b6 [0-2] b6 57 a7 4c b1}  //weight: 1, accuracy: Low
        $x_1_5 = {03 19 be 19 c0 b6 3a [0-4] 03 bd 3a 19 04 bd 59 03 13 53 b6 3a [0-4] 19 04 bd 59 03 2b 53 b6 57 [0-4] a7 3a 03 b8 b1}  //weight: 1, accuracy: Low
        $x_1_6 = {bb 59 bb 59 b2 b8 03 bd 04 59 58 b7 2a b7 4c 2b b0 57 4b 01 b0}  //weight: 1, accuracy: High
        $x_1_7 = {03 bd 3a 03 bd 3a 12 b8 12 b8 04 bd 59 03 13 53 12 b8 05 bd 59 03 13 53 59 04 13 53 b8 04 bd 59 03 05 bd 59}  //weight: 1, accuracy: High
        $x_10_8 = {1e 6a 61 76 61 2f 73 65 63 75 72 69 74 79 2f 50 72 6f 74 65 63 74 69 6f 6e 44 6f 6d 61 69 6e}  //weight: 10, accuracy: High
        $x_10_9 = {18 6a 61 76 61 2f 73 65 63 75 72 69 74 79 2f 43 6f 64 65 53 6f 75 72 63 65}  //weight: 10, accuracy: High
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_10_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Exploit_Java_Blacole_GQ_2147665955_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Java/Blacole.GQ"
        threat_id = "2147665955"
        type = "Exploit"
        platform = "Java: Java binaries (classes)"
        family = "Blacole"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {4f 05 36 06 11 10 64 bc 08 3a 07 19 07 04 10 5a 54 19 07 03 10 44 54 19 04 19 07 03 05 b6 ?? ?? 06 36 09 2c 19 07 b6}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Exploit_Java_Blacole_GS_2147666642_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Java/Blacole.GS"
        threat_id = "2147666642"
        type = "Exploit"
        platform = "Java: Java binaries (classes)"
        family = "Blacole"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_2_1 = {3a 09 10 5a 36 0a 10 4d 36 0b 19 09 04 33 15 ?? 9a ?? ?? 15 0a a0 ?? ?? a7 00 04 bf 19 09 03 33 15 00 9a ?? ?? a7 00 04 bf 15 0b a0}  //weight: 2, accuracy: Low
        $x_1_2 = {3a 09 10 5a 36 0a 10 4d 36 0b 19 09 04 33 15 ?? 9a ?? ?? 15 0a a0 ?? ?? a7 00 04 bf}  //weight: 1, accuracy: Low
        $x_1_3 = {3a 09 10 5a 36 0a 10 4d 36 0b 19 09 03 33 15 ?? 9a ?? ?? 15 0b a0 ?? ?? a7 00 04 bf}  //weight: 1, accuracy: Low
        $x_1_4 = {15 0c 19 09 be a1 ff d9 07 15 ?? 9a ff e1 a7 00 04 bf bd ?? ?? 59}  //weight: 1, accuracy: Low
        $x_2_5 = {3a 0a 10 5a 36 0b 10 4d 36 0c 19 0a 04 33 15 ?? 9a ?? ?? 15 0b a0 ?? ?? a7 00 04 bf 19 0a 03 33 15 00 9a ?? ?? a7 00 04 bf 15 0c a0}  //weight: 2, accuracy: Low
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_1_*))) or
            ((1 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule Exploit_Java_Blacole_GT_2147666876_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Java/Blacole.GT"
        threat_id = "2147666876"
        type = "Exploit"
        platform = "Java: Java binaries (classes)"
        family = "Blacole"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_2_1 = {10 41 10 5a a7 00 04 bf b8 ?? ?? 3e 1d 10 41 a1 ff f1 1d 10 5a 15 05 9a ff f1}  //weight: 2, accuracy: Low
        $x_1_2 = {11 10 00 bc 08 3a 08 a7 00 0d 19 07 19 08 03 15 09 b6 ?? ?? 19 06 19 08 b6}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Exploit_Java_Blacole_GX_2147670814_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Java/Blacole.GX"
        threat_id = "2147670814"
        type = "Exploit"
        platform = "Java: Java binaries (classes)"
        family = "Blacole"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "12"
        strings_accuracy = "Low"
    strings:
        $x_10_1 = {2a b6 13 04 bd 59 03 13 53 b8 b0}  //weight: 10, accuracy: High
        $x_10_2 = {2a b6 12 04 bd 59 03 12 53 b8 b0}  //weight: 10, accuracy: High
        $x_1_3 = {01 00 09 74 65 73 74 2e 6a 61 76 61 00}  //weight: 1, accuracy: High
        $x_1_4 = {61 73 64 61 73 64 [0-128] 6c 6f 61 64 43 6c 61 73 73}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_10_*) and 2 of ($x_1_*))) or
            ((2 of ($x_10_*))) or
            (all of ($x*))
        )
}

rule Exploit_Java_Blacole_HC_2147678607_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Java/Blacole.HC"
        threat_id = "2147678607"
        type = "Exploit"
        platform = "Java: Java binaries (classes)"
        family = "Blacole"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_3_1 = {b6 c0 3a 19 b6 57 19 13 05 bd 59 03 12 53 59 04 13 53 b6 3a 19 01 05 bd 59 03 2b 53 59 04 13 53 b6 57}  //weight: 3, accuracy: High
        $x_1_2 = {bb 59 b7 4e 2d 13 01 01 b6 c0 3a 19 b6 3a 19 b2 08 32 b8 01 b6 3a 19 b2}  //weight: 1, accuracy: High
        $x_1_3 = {53 b6 2a b8 04 bd 59 03 2b 53 b6 b0}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_3_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

