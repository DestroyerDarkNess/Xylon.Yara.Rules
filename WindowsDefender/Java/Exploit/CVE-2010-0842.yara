rule Exploit_Java_CVE_2010_0842_A_2147654473_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Java/CVE-2010-0842.gen!A"
        threat_id = "2147654473"
        type = "Exploit"
        platform = "Java: Java binaries (classes)"
        family = "CVE-2010-0842"
        severity = "Critical"
        info = "gen: malware that is detected using a generic signature"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "12"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "%()[Ljavax/sound/midi/MidiDevice$Info;" ascii //weight: 1
        $x_1_2 = ")(Ljava/lang/String;)Ljava/io/InputStream;" ascii //weight: 1
        $x_1_3 = "0(Ljavax/sound/midi/ControllerEventListener;[I)[I" ascii //weight: 1
        $x_1_4 = "A(Ljavax/sound/midi/MidiDevice$Info;)Ljavax/sound/midi/MidiDevice;" ascii //weight: 1
        $x_1_5 = "addControllerEventListener" ascii //weight: 1
        $x_1_6 = "getClass" ascii //weight: 1
        $x_1_7 = "getMidiDeviceInfo" ascii //weight: 1
        $x_1_8 = "getParameter" ascii //weight: 1
        $x_1_9 = "getResourceAsStream" ascii //weight: 1
        $x_1_10 = "javax/sound/midi/MidiSystem" ascii //weight: 1
        $x_1_11 = "javax/sound/midi/Sequencer" ascii //weight: 1
        $x_1_12 = "setSequence" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

