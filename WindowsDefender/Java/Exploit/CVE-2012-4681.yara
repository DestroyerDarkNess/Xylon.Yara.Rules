rule Exploit_Java_CVE_2012_4681_HG_2147664505_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Java/CVE-2012-4681.HG"
        threat_id = "2147664505"
        type = "Exploit"
        platform = "Java: Java binaries (classes)"
        family = "CVE-2012-4681"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "12"
        strings_accuracy = "Low"
    strings:
        $x_10_1 = {03 33 10 4d a0 00 ?? 19 ?? 04 33 10 5a a0 00}  //weight: 10, accuracy: Low
        $x_2_2 = {53 b6 2a b8 04 bd 59 03 2b 53 b6 b0}  //weight: 2, accuracy: High
        $x_1_3 = "java/security/ProtectionDomain" ascii //weight: 1
        $x_1_4 = {6a 61 76 61 (2f|2e 6c) 61 6e 67 (2f|2e 43) 6c 61 73 73 4c 6f 61 64 65 72}  //weight: 1, accuracy: Low
        $x_2_5 = "regsvr32 -s \"%s\"" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_10_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule Exploit_Java_CVE_2012_4681_AIK_2147665558_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Java/CVE-2012-4681.AIK"
        threat_id = "2147665558"
        type = "Exploit"
        platform = "Java: Java binaries (classes)"
        family = "CVE-2012-4681"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "6"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {01 00 3a 28 4c 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74 3b 4c 6a 61 76 61 2f 6c 61 6e 67 2f 53 74 72 69 6e 67 3b 5b 4c 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74 3b 29 56}  //weight: 1, accuracy: High
        $x_1_2 = {01 00 22 28 29 4c 6a 61 76 61 2f 73 65 63 75 72 69 74 79 2f 50 72 6f 74 65 63 74 69 6f 6e 44 6f 6d 61 69 6e 3b}  //weight: 1, accuracy: High
        $x_1_3 = {01 00 14 6a 61 76 61 2f 62 65 61 6e 73 2f 53 74 61 74 65 6d 65 6e 74}  //weight: 1, accuracy: High
        $x_1_4 = {01 00 10 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74}  //weight: 1, accuracy: High
        $x_1_5 = {01 00 39 28 4c 6a 61 76 61 2f 73 65 63 75 72 69 74 79 2f 50 72 6f 74 65 63 74 69 6f 6e 44 6f 6d 61 69 6e 3b 4c 6a 61 76 61 2f 62 65 61 6e 73 2f 53 74 61 74 65 6d 65 6e 74 3b 29 56}  //weight: 1, accuracy: High
        $x_1_6 = {59 2b 2c 04 bd 00 ?? b7 00 ?? 4e bb 00 ?? 59 b7 00 ?? 3a 04 19 04 b6 00 ?? 3a 05 2a 19 05 2d b6 00 ?? b1}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Exploit_Java_CVE_2012_4681_AIL_2147665563_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Java/CVE-2012-4681.AIL"
        threat_id = "2147665563"
        type = "Exploit"
        platform = "Java: Java binaries (classes)"
        family = "CVE-2012-4681"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "7"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {01 00 3d 28 4c 6a 61 76 61 2f 73 65 63 75 72 69 74 79 2f 50 72 69 76 69 6c 65 67 65 64 45 78 63 65 70 74 69 6f 6e 41 63 74 69 6f 6e 3b 29 4c 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74 3b}  //weight: 1, accuracy: High
        $x_1_2 = {01 00 10 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74}  //weight: 1, accuracy: High
        $x_1_3 = {01 00 27 28 4c 6a 61 76 61 2f 6c 61 6e 67 2f 53 74 72 69 6e 67 3b 4c 6a 61 76 61 2f 6c 61 6e 67 2f 53 74 72 69 6e 67 3b 29 56}  //weight: 1, accuracy: High
        $x_1_4 = {01 00 1e 6a 61 76 61 2f 73 65 63 75 72 69 74 79 2f 41 63 63 65 73 73 43 6f 6e 74 72 6f 6c 6c 65 72}  //weight: 1, accuracy: High
        $x_1_5 = {01 00 06 3c 69 6e 69 74 3e}  //weight: 1, accuracy: High
        $x_1_6 = {01 00 0c 64 6f 50 72 69 76 69 6c 65 67 65 64}  //weight: 1, accuracy: High
        $x_1_7 = {2a b7 00 01 00 00 2a b7 00 01 2a 12 02 b5 00 03 2a 12 04 b5 00 05 2a b8 00 06 57 2a 2b 2c b6 00 07 a7 00 04}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Exploit_Java_CVE_2012_4681_AIM_2147665570_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Java/CVE-2012-4681.AIM"
        threat_id = "2147665570"
        type = "Exploit"
        platform = "Java: Java binaries (classes)"
        family = "CVE-2012-4681"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "13"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {01 00 07 65 78 65 63 75 74 65}  //weight: 1, accuracy: High
        $x_1_2 = {01 00 0c 5a 6d 39 79 54 6d 46 74 5a 51 3d 3d}  //weight: 1, accuracy: High
        $x_1_3 = {01 00 10 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74}  //weight: 1, accuracy: High
        $x_1_4 = {01 00 0f 6a 61 76 61 2f 6c 61 6e 67 2f 43 6c 61 73 73}  //weight: 1, accuracy: High
        $x_1_5 = {01 00 0e 64 65 66 67 64 31 31 2f 42 61 73 65 36 34}  //weight: 1, accuracy: High
        $x_1_6 = {01 00 10 6a 61 76 61 2f 6c 61 6e 67 2f 53 74 72 69 6e 67}  //weight: 1, accuracy: High
        $x_1_7 = {01 00 06 64 65 63 6f 64 65}  //weight: 1, accuracy: High
        $x_1_8 = {01 00 3a 28 4c 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74 3b 4c 6a 61 76 61 2f 6c 61 6e 67 2f 53 74 72 69 6e 67 3b 5b 4c 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74 3b 29 56}  //weight: 1, accuracy: High
        $x_1_9 = {01 00 14 28 29 4c 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74 3b}  //weight: 1, accuracy: High
        $x_1_10 = {01 00 15 6a 61 76 61 2f 62 65 61 6e 73 2f 45 78 70 72 65 73 73 69 6f 6e}  //weight: 1, accuracy: High
        $x_1_11 = {01 00 08 67 65 74 56 61 6c 75 65}  //weight: 1, accuracy: High
        $x_1_12 = {01 00 08 67 65 74 42 79 74 65 73}  //weight: 1, accuracy: High
        $x_1_13 = {04 bd 00 27 00 00 04 bd 00 27 4d 2c 03 2b 53 bb 00 63 59 12 65 bb 00 16 59 12 67 b6 00 1a b8 00 1e b7 00 24 2c b7 00 69 4e 2d b6 00 6a 2d b6 00 6b c0 00 65 b0}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Exploit_Java_CVE_2012_4681_AIN_2147665812_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Java/CVE-2012-4681.AIN"
        threat_id = "2147665812"
        type = "Exploit"
        platform = "Java: Java binaries (classes)"
        family = "CVE-2012-4681"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "10"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {01 00 07 65 78 65 63 75 74 65}  //weight: 1, accuracy: High
        $x_1_2 = {01 00 07 66 6f 72 4e 61 6d 65}  //weight: 1, accuracy: High
        $x_1_3 = {01 00 10 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74}  //weight: 1, accuracy: High
        $x_1_4 = {01 00 0f 6a 61 76 61 2f 6c 61 6e 67 2f 43 6c 61 73 73}  //weight: 1, accuracy: High
        $x_1_5 = {01 00 06 3c 69 6e 69 74 3e}  //weight: 1, accuracy: High
        $x_1_6 = {01 00 08 67 65 74 56 61 6c 75 65}  //weight: 1, accuracy: High
        $x_1_7 = {01 00 3a 28 4c 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74 3b 4c 6a 61 76 61 2f 6c 61 6e 67 2f 53 74 72 69 6e 67 3b 5b 4c 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74 3b 29 56}  //weight: 1, accuracy: High
        $x_1_8 = {01 00 14 28 29 4c 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74 3b}  //weight: 1, accuracy: High
        $x_1_9 = {01 00 15 6a 61 76 61 2f 62 65 61 6e 73 2f 45 78 70 72 65 73 73 69 6f 6e}  //weight: 1, accuracy: High
        $x_1_10 = {04 bd 4d 2c 03 2b 53 bb 59 13 12 2c b7 4e 2d b6 2d b6 c0 b0}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Exploit_Java_CVE_2012_4681_AIO_2147665813_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Java/CVE-2012-4681.AIO"
        threat_id = "2147665813"
        type = "Exploit"
        platform = "Java: Java binaries (classes)"
        family = "CVE-2012-4681"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "11"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {01 00 25 28 4c 6a 61 76 61 2f 6c 61 6e 67 2f 53 74 72 69 6e 67 3b 29 4c 6a 61 76 61 2f 6c 61 6e 67 2f 43 6c 61 73 73 3b}  //weight: 1, accuracy: High
        $x_1_2 = {01 00 3a 28 4c 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74 3b 4c 6a 61 76 61 2f 6c 61 6e 67 2f 53 74 72 69 6e 67 3b 5b 4c 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74 3b 29 56}  //weight: 1, accuracy: High
        $x_1_3 = {01 00 12 73 75 6e 2e 61 77 74 2e 53 75 6e 54 6f 6f 6c 6b 69 74}  //weight: 1, accuracy: High
        $x_1_4 = {01 00 15 6a 61 76 61 2f 62 65 61 6e 73 2f 45 78 70 72 65 73 73 69 6f 6e}  //weight: 1, accuracy: High
        $x_1_5 = {01 00 14 28 29 4c 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74 3b}  //weight: 1, accuracy: High
        $x_1_6 = {01 00 17 6a 61 76 61 2f 6c 61 6e 67 2f 72 65 66 6c 65 63 74 2f 46 69 65 6c 64}  //weight: 1, accuracy: High
        $x_1_7 = {01 00 07 65 78 65 63 75 74 65}  //weight: 1, accuracy: High
        $x_1_8 = {01 00 10 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74}  //weight: 1, accuracy: High
        $x_1_9 = {01 00 08 67 65 74 56 61 6c 75 65}  //weight: 1, accuracy: High
        $x_1_10 = {01 00 27 28 4c 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74 3b 4c 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74 3b 29 56}  //weight: 1, accuracy: High
        $x_1_11 = {05 bd 3a 19 03 2b 53 19 04 2c 53 bb 59 2a 12 b7 12 19 b7 3a 19 b6 19 b6 c0 2d 19 b6 b1}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Exploit_Java_CVE_2012_4681_AJW_2147665936_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Java/CVE-2012-4681.AJW"
        threat_id = "2147665936"
        type = "Exploit"
        platform = "Java: Java binaries (classes)"
        family = "CVE-2012-4681"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "10"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {01 00 12 6a 61 76 61 2f 61 70 70 6c 65 74 2f 41 70 70 6c 65 74}  //weight: 1, accuracy: High
        $x_1_2 = {01 00 12 4c 6a 61 76 61 2f 6c 61 6e 67 2f 53 74 72 69 6e 67 3b}  //weight: 1, accuracy: High
        $x_1_3 = {01 00 06 3c 69 6e 69 74 3e}  //weight: 1, accuracy: High
        $x_1_4 = {01 00 06 73 74 72 31 6e 67}  //weight: 1, accuracy: High
        $x_1_5 = {01 00 07 4d 61 6e 61 67 65 72}  //weight: 1, accuracy: High
        $x_1_6 = {01 00 08 73 61 6e 69 74 69 7a 65}  //weight: 1, accuracy: High
        $x_1_7 = {01 00 06 66 6f 6b 61 73 72}  //weight: 1, accuracy: High
        $x_1_8 = {01 00 07 73 74 72 69 6e 67 73}  //weight: 1, accuracy: High
        $x_1_9 = {2a 10 08 bc 05 59 03 10 66 55 59 04 10 69 55 59 05 10 6c 55 59 06 10 65 55 59 07 10 3a 55 59 08 10 2f 55 59 10 06 10 2f 55 59 10 07 10 2f 55}  //weight: 1, accuracy: High
        $x_1_10 = {03 10 73 55 59 04 10 75 55 59 05 10 6e 55 59 06 10 2e 55 59 07 10 61 55 59 08 10 77 55 59 10 06 10 74 55 59 10 07 10 2e 55 59 10 08 10 53 55 59 10 09 10 75 55 59 10 0a 10 6e 55 59 10 0b 10 54 55 59 10 0c 10 6f 55 59 10 0d 10 6f 55 59 10 0e 10 6c 55 59 10 0f 10 6b 55 59 10 10 10 69 55 59 10 11 10 74 55}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Exploit_Java_CVE_2012_4681_ALC_2147666042_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Java/CVE-2012-4681.ALC"
        threat_id = "2147666042"
        type = "Exploit"
        platform = "Java: Java binaries (classes)"
        family = "CVE-2012-4681"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "12"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {01 00 25 28 4c 6a 61 76 61 2f 6c 61 6e 67 2f 53 74 72 69 6e 67 3b 29 4c 6a 61 76 61 2f 6c 61 6e 67 2f 43 6c 61 73 73 3b}  //weight: 1, accuracy: High
        $x_1_2 = {01 00 3a 28 4c 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74 3b 4c 6a 61 76 61 2f 6c 61 6e 67 2f 53 74 72 69 6e 67 3b 5b 4c 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74 3b 29 56}  //weight: 1, accuracy: High
        $x_1_3 = {01 00 12 73 75 6e 2e 61 77 74 2e 53 75 6e 54 6f 6f 6c 6b 69 74}  //weight: 1, accuracy: High
        $x_1_4 = {01 00 15 6a 61 76 61 2f 62 65 61 6e 73 2f 45 78 70 72 65 73 73 69 6f 6e}  //weight: 1, accuracy: High
        $x_1_5 = {01 00 14 28 29 4c 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74 3b}  //weight: 1, accuracy: High
        $x_1_6 = {01 00 17 6a 61 76 61 2f 6c 61 6e 67 2f 72 65 66 6c 65 63 74 2f 46 69 65 6c 64}  //weight: 1, accuracy: High
        $x_1_7 = {01 00 07 65 78 65 63 75 74 65}  //weight: 1, accuracy: High
        $x_1_8 = {01 00 10 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74}  //weight: 1, accuracy: High
        $x_1_9 = {01 00 06 3c 69 6e 69 74 3e}  //weight: 1, accuracy: High
        $x_1_10 = {01 00 08 67 65 74 56 61 6c 75 65}  //weight: 1, accuracy: High
        $x_1_11 = {01 00 27 28 4c 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74 3b 4c 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74 3b 29 56}  //weight: 1, accuracy: High
        $x_1_12 = {05 bd 3a 19 03 2b 53 19 04 2c 53 bb 59 2a 12 b7 12 19 b7 3a 19 b6 19 b6 c0 2d 19 b6 b1}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Exploit_Java_CVE_2012_4681_ALD_2147666043_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Java/CVE-2012-4681.ALD"
        threat_id = "2147666043"
        type = "Exploit"
        platform = "Java: Java binaries (classes)"
        family = "CVE-2012-4681"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "22"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {01 00 1d 28 4c 6a 61 76 61 2f 73 65 63 75 72 69 74 79 2f 50 65 72 6d 69 73 73 69 6f 6e 3b 29 56}  //weight: 1, accuracy: High
        $x_1_2 = {01 00 19 6a 61 76 61 2f 73 65 63 75 72 69 74 79 2f 50 65 72 6d 69 73 73 69 6f 6e 73}  //weight: 1, accuracy: High
        $x_1_3 = {01 00 12 73 65 74 53 65 63 75 72 69 74 79 4d 61 6e 61 67 65 72}  //weight: 1, accuracy: High
        $x_1_4 = {01 00 3a 28 4c 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74 3b 4c 6a 61 76 61 2f 6c 61 6e 67 2f 53 74 72 69 6e 67 3b 5b 4c 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74 3b 29 56}  //weight: 1, accuracy: High
        $x_1_5 = {01 00 41 28 4c 6a 61 76 61 2f 73 65 63 75 72 69 74 79 2f 43 6f 64 65 53 6f 75 72 63 65 3b 4c 6a 61 76 61 2f 73 65 63 75 72 69 74 79 2f 50 65 72 6d 69 73 73 69 6f 6e 43 6f 6c 6c 65 63 74 69 6f 6e 3b 29 56}  //weight: 1, accuracy: High
        $x_1_6 = {01 00 1e 6a 61 76 61 2f 73 65 63 75 72 69 74 79 2f 63 65 72 74 2f 43 65 72 74 69 66 69 63 61 74 65}  //weight: 1, accuracy: High
        $x_1_7 = {01 00 32 28 4c 6a 61 76 61 2f 6e 65 74 2f 55 52 4c 3b 5b 4c 6a 61 76 61 2f 73 65 63 75 72 69 74 79 2f 63 65 72 74 2f 43 65 72 74 69 66 69 63 61 74 65 3b 29 56}  //weight: 1, accuracy: High
        $x_1_8 = {01 00 22 6a 61 76 61 2f 73 65 63 75 72 69 74 79 2f 41 63 63 65 73 73 43 6f 6e 74 72 6f 6c 43 6f 6e 74 65 78 74}  //weight: 1, accuracy: High
        $x_1_9 = {01 00 1e 6a 61 76 61 2f 73 65 63 75 72 69 74 79 2f 50 72 6f 74 65 63 74 69 6f 6e 44 6f 6d 61 69 6e}  //weight: 1, accuracy: High
        $x_1_10 = {01 00 0c 6a 61 76 61 2f 6e 65 74 2f 55 52 4c}  //weight: 1, accuracy: High
        $x_1_11 = {01 00 15 28 4c 6a 61 76 61 2f 6c 61 6e 67 2f 53 74 72 69 6e 67 3b 29 56}  //weight: 1, accuracy: High
        $x_1_12 = {01 00 10 6a 61 76 61 2f 6c 61 6e 67 2f 53 79 73 74 65 6d}  //weight: 1, accuracy: High
        $x_1_13 = {01 00 08 66 69 6c 65 3a 2f 2f 2f}  //weight: 1, accuracy: High
        $x_1_14 = {01 00 07 65 78 65 63 75 74 65}  //weight: 1, accuracy: High
        $x_1_15 = {01 00 14 6a 61 76 61 2f 62 65 61 6e 73 2f 53 74 61 74 65 6d 65 6e 74}  //weight: 1, accuracy: High
        $x_1_16 = {01 00 10 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74}  //weight: 1, accuracy: High
        $x_1_17 = {01 00 1b 6a 61 76 61 2f 73 65 63 75 72 69 74 79 2f 41 6c 6c 50 65 72 6d 69 73 73 69 6f 6e}  //weight: 1, accuracy: High
        $x_1_18 = {01 00 06 3c 69 6e 69 74 3e}  //weight: 1, accuracy: High
        $x_1_19 = {01 00 24 28 5b 4c 6a 61 76 61 2f 73 65 63 75 72 69 74 79 2f 50 72 6f 74 65 63 74 69 6f 6e 44 6f 6d 61 69 6e 3b 29 56}  //weight: 1, accuracy: High
        $x_1_20 = {01 00 4a 28 4c 6a 61 76 61 2f 6c 61 6e 67 2f 43 6c 61 73 73 3b 4c 6a 61 76 61 2f 6c 61 6e 67 2f 53 74 72 69 6e 67 3b 4c 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74 3b 4c 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74 3b 29 56}  //weight: 1, accuracy: High
        $x_1_21 = {01 00 18 6a 61 76 61 2f 73 65 63 75 72 69 74 79 2f 43 6f 64 65 53 6f 75 72 63 65}  //weight: 1, accuracy: High
        $x_1_22 = {bb 59 13 12 04 bd b7 4c bb 59 b7 4d 2c bb 59 b7 b6 bb 59 bb 59 bb 59 12 b7 03 bd b7 2c b7 4e bb 59 04 bd 59 03 2d 53 b7 3a 2a 13 12 2b 19 b7 2b b6 b1}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Exploit_Java_CVE_2012_4681_ALE_2147666044_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Java/CVE-2012-4681.ALE"
        threat_id = "2147666044"
        type = "Exploit"
        platform = "Java: Java binaries (classes)"
        family = "CVE-2012-4681"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "10"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {01 00 07 65 78 65 63 75 74 65}  //weight: 1, accuracy: High
        $x_1_2 = {01 00 10 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74}  //weight: 1, accuracy: High
        $x_1_3 = {01 00 0e 6a 61 76 61 2f 6c 61 6e 67 2f 4d 61 74 68}  //weight: 1, accuracy: High
        $x_1_4 = {01 00 0f 6a 61 76 61 2f 6c 61 6e 67 2f 43 6c 61 73 73}  //weight: 1, accuracy: High
        $x_1_5 = {01 00 06 3c 69 6e 69 74 3e}  //weight: 1, accuracy: High
        $x_1_6 = {01 00 08 67 65 74 56 61 6c 75 65}  //weight: 1, accuracy: High
        $x_1_7 = {01 00 3a 28 4c 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74 3b 4c 6a 61 76 61 2f 6c 61 6e 67 2f 53 74 72 69 6e 67 3b 5b 4c 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74 3b 29 56}  //weight: 1, accuracy: High
        $x_1_8 = {01 00 14 28 29 4c 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74 3b}  //weight: 1, accuracy: High
        $x_1_9 = {01 00 15 6a 61 76 61 2f 62 65 61 6e 73 2f 45 78 70 72 65 73 73 69 6f 6e}  //weight: 1, accuracy: High
        $x_1_10 = {02 b8 bd 4e 2d 03 b8 2b 53 bb 59 13 2c 2d b7 3a 19 b6 19 b6 c0 b0}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Exploit_Java_CVE_2012_4681_ALF_2147666045_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Java/CVE-2012-4681.ALF"
        threat_id = "2147666045"
        type = "Exploit"
        platform = "Java: Java binaries (classes)"
        family = "CVE-2012-4681"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {01 00 22 28 29 4c 6a 61 76 61 2f 73 65 63 75 72 69 74 79 2f 50 72 6f 74 65 63 74 69 6f 6e 44 6f 6d 61 69 6e 3b}  //weight: 1, accuracy: High
        $x_1_2 = {01 00 10 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74}  //weight: 1, accuracy: High
        $x_1_3 = {01 00 3a 28 4c 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74 3b 4c 6a 61 76 61 2f 6c 61 6e 67 2f 53 74 72 69 6e 67 3b 5b 4c 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74 3b 29 56}  //weight: 1, accuracy: High
        $x_1_4 = {01 00 06 3c 69 6e 69 74 3e}  //weight: 1, accuracy: High
        $x_1_5 = {01 00 14 6a 61 76 61 2f 62 65 61 6e 73 2f 53 74 61 74 65 6d 65 6e 74}  //weight: 1, accuracy: High
        $x_1_6 = {01 00 39 28 4c 6a 61 76 61 2f 73 65 63 75 72 69 74 79 2f 50 72 6f 74 65 63 74 69 6f 6e 44 6f 6d 61 69 6e 3b 4c 6a 61 76 61 2f 62 65 61 6e 73 2f 53 74 61 74 65 6d 65 6e 74 3b 29 56}  //weight: 1, accuracy: High
        $x_1_7 = {bb 59 2b 2c 04 bd b7 4e bb 59 b7 3a 19 b6 3a 2a 19 2d b6 b1}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Exploit_Java_CVE_2012_4681_ALG_2147666046_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Java/CVE-2012-4681.ALG"
        threat_id = "2147666046"
        type = "Exploit"
        platform = "Java: Java binaries (classes)"
        family = "CVE-2012-4681"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "10"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {01 00 07 65 78 65 63 75 74 65}  //weight: 1, accuracy: High
        $x_1_2 = {01 00 07 66 6f 72 4e 61 6d 65}  //weight: 1, accuracy: High
        $x_1_3 = {01 00 10 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74}  //weight: 1, accuracy: High
        $x_1_4 = {01 00 0f 6a 61 76 61 2f 6c 61 6e 67 2f 43 6c 61 73 73}  //weight: 1, accuracy: High
        $x_1_5 = {01 00 06 3c 69 6e 69 74 3e}  //weight: 1, accuracy: High
        $x_1_6 = {01 00 08 67 65 74 56 61 6c 75 65}  //weight: 1, accuracy: High
        $x_1_7 = {01 00 3a 28 4c 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74 3b 4c 6a 61 76 61 2f 6c 61 6e 67 2f 53 74 72 69 6e 67 3b 5b 4c 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74 3b 29 56}  //weight: 1, accuracy: High
        $x_1_8 = {01 00 14 28 29 4c 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74 3b}  //weight: 1, accuracy: High
        $x_1_9 = {01 00 15 6a 61 76 61 2f 62 65 61 6e 73 2f 45 78 70 72 65 73 73 69 6f 6e}  //weight: 1, accuracy: High
        $x_1_10 = {04 bd 4d 12 4e 2c 03 2b 53 bb 59 13 12 2c b7 3a 19 b6 19 b6 c0 b0}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Exploit_Java_CVE_2012_4681_ALH_2147666047_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Java/CVE-2012-4681.ALH"
        threat_id = "2147666047"
        type = "Exploit"
        platform = "Java: Java binaries (classes)"
        family = "CVE-2012-4681"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "14"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {01 00 4e 28 4c 6a 61 76 61 2f 75 74 69 6c 2f 63 6f 6e 63 75 72 72 65 6e 74 2f 61 74 6f 6d 69 63 2f 41 74 6f 6d 69 63 52 65 66 65 72 65 6e 63 65 41 72 72 61 79 3b 29 4c 6a 61 76 61 2f 6c 61 6e 67 2f 72 65 66 6c 65 63 74 2f 4d 65 74 68 6f 64 3b}  //weight: 1, accuracy: High
        $x_1_2 = {01 00 0f 6a 61 76 61 2f 6c 61 6e 67 2f 43 6c 61 73 73}  //weight: 1, accuracy: High
        $x_1_3 = {01 00 06 69 6e 76 6f 6b 65}  //weight: 1, accuracy: High
        $x_1_4 = {01 00 39 28 4c 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74 3b 5b 4c 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74 3b 29 4c 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74 3b}  //weight: 1, accuracy: High
        $x_1_5 = {01 00 30 6a 61 76 61 2f 75 74 69 6c 2f 63 6f 6e 63 75 72 72 65 6e 74 2f 61 74 6f 6d 69 63 2f 41 74 6f 6d 69 63 52 65 66 65 72 65 6e 63 65 41 72 72 61 79}  //weight: 1, accuracy: High
        $x_1_6 = {01 00 11 6a 61 76 61 2f 6c 61 6e 67 2f 49 6e 74 65 67 65 72}  //weight: 1, accuracy: High
        $x_1_7 = {01 00 16 28 49 29 4c 6a 61 76 61 2f 6c 61 6e 67 2f 49 6e 74 65 67 65 72 3b}  //weight: 1, accuracy: High
        $x_1_8 = {01 00 10 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74}  //weight: 1, accuracy: High
        $x_1_9 = {01 00 07 76 61 6c 75 65 4f 66}  //weight: 1, accuracy: High
        $x_1_10 = {01 00 26 28 4c 6a 61 76 61 2f 6c 61 6e 67 2f 53 74 72 69 6e 67 3b 29 4c 6a 61 76 61 2f 6c 61 6e 67 2f 53 74 72 69 6e 67 3b}  //weight: 1, accuracy: High
        $x_1_11 = {01 00 0e 67 65 74 43 6c 61 73 73 4c 6f 61 64 65 72}  //weight: 1, accuracy: High
        $x_1_12 = {01 00 18 6a 61 76 61 2f 6c 61 6e 67 2f 72 65 66 6c 65 63 74 2f 4d 65 74 68 6f 64}  //weight: 1, accuracy: High
        $x_1_13 = {01 00 19 28 29 4c 6a 61 76 61 2f 6c 61 6e 67 2f 43 6c 61 73 73 4c 6f 61 64 65 72 3b}  //weight: 1, accuracy: High
        $x_1_14 = {2c b8 3a 2d b8 3a 19 04 32 c0 3a 2b b6 3a 05 bd 59 03 03 b8 53 59 04 19 53 3a 19 b8 3a 19 19 19 b6 57 2a 2b 19 19 19 b8 a7}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Exploit_Java_CVE_2012_4681_AUB_2147671237_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Java/CVE-2012-4681.AUB"
        threat_id = "2147671237"
        type = "Exploit"
        platform = "Java: Java binaries (classes)"
        family = "CVE-2012-4681"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "10"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {01 00 1e 6a 61 76 61 2f 73 65 63 75 72 69 74 79 2f 50 72 6f 74 65 63 74 69 6f 6e 44 6f 6d 61 69 6e}  //weight: 1, accuracy: High
        $x_1_2 = {01 00 19 6a 61 76 61 2f 73 65 63 75 72 69 74 79 2f 50 65 72 6d 69 73 73 69 6f 6e 73}  //weight: 1, accuracy: High
        $x_1_3 = {01 00 1e 6a 61 76 61 2f 73 65 63 75 72 69 74 79 2f 63 65 72 74 2f 43 65 72 74 69 66 69 63 61 74 65}  //weight: 1, accuracy: High
        $x_1_4 = {01 00 12 73 65 74 53 65 63 75 72 69 74 79 4d 61 6e 61 67 65 72}  //weight: 1, accuracy: High
        $x_1_5 = {01 00 03 73 75 6e}  //weight: 1, accuracy: High
        $x_1_6 = {01 00 03 61 77 74}  //weight: 1, accuracy: High
        $x_1_7 = {01 00 0a 53 75 6e 54 6f 6f 6c 6b 69 74}  //weight: 1, accuracy: High
        $x_1_8 = {01 00 2e 37 38 39 67 38 37 39 35 65 34 35 36 35 74 35 37 36 35 46 35 36 37 35 35 36 37 69 36 37 36 35 65 37 35 36 35 36 37 6c 35 36 37 64 35 36 37}  //weight: 1, accuracy: High
        $x_1_9 = {2a 10 08 bc 05 59 03 10 66 55 59 04 10 69 55 59 05 10 6c 55 59 06 10 65 55 59 07 10 3a 55 59 08 10 2f 55 59 10 06 10 2f 55 59 10 07 10 2f 55 b5 00 04}  //weight: 1, accuracy: High
        $x_1_10 = {2a 12 b7 3a 19 06 bd 59 03 13 53 59 04 13 53 59 05 13 53 b6 3a 19 06 bd 59 03 2a 12 b7 53 59 04 2a b4 53 59 05 04 bd 53 b6 3a 2d 19 19 b6 19 b6 12 03 bd b6 3a}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

