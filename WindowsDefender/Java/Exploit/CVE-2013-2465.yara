rule Exploit_Java_CVE_2013_2465_C_2147689095_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Java/CVE-2013-2465.C"
        threat_id = "2147689095"
        type = "Exploit"
        platform = "Java: Java binaries (classes)"
        family = "CVE-2013-2465"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {4d 61 69 6e 65 72 01 00 04 65 78 65 63 [0-3] 28 4c 6a 61 76 61 2f 6c 61 6e 67 2f 53 74 72 69 6e 67 3b 29 4c 6a 61 76 61 2f 6c 61 6e 67 2f 50 72 6f 63 65 73 73 3b [0-32] 76 61 6c 75 65 4f 66 [0-96] 70 61 72 73 65 42 61 73 65 36 34 42 69 6e 61 72 79}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Exploit_Java_CVE_2013_2465_A_2147815479_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Java/CVE-2013-2465.A!MTB"
        threat_id = "2147815479"
        type = "Exploit"
        platform = "Java: Java binaries (classes)"
        family = "CVE-2013-2465"
        severity = "Critical"
        info = "MTB: Microsoft Threat Behavior"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "MyJApplet" ascii //weight: 1
        $x_1_2 = "dropAndExecuteAgent" ascii //weight: 1
        $x_1_3 = "tryExpl" ascii //weight: 1
        $x_1_4 = "createWritableRaster" ascii //weight: 1
        $x_1_5 = "DropIt" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

