rule Trojan_Java_CVE_2010_4465_A_2147659890_0
{
    meta:
        author = "defender2yara"
        detection_name = "Trojan:Java/CVE-2010-4465.A"
        threat_id = "2147659890"
        type = "Trojan"
        platform = "Java: Java binaries (classes)"
        family = "CVE-2010-4465"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "45"
        strings_accuracy = "High"
    strings:
        $x_5_1 = "main$jtfield" ascii //weight: 5
        $x_5_2 = "javax/swing/Timer" ascii //weight: 5
        $x_5_3 = "javax/swing/text/DefaultEditorKit$CopyAction" ascii //weight: 5
        $x_5_4 = "java/awt/datatransfer/ClipboardOwner" ascii //weight: 5
        $x_5_5 = "java/awt/datatransfer/Transferable" ascii //weight: 5
        $x_2_6 = "newInstance" ascii //weight: 2
        $x_2_7 = "getClassLoader" ascii //weight: 2
        $x_2_8 = "getResourceAsStream" ascii //weight: 2
        $x_2_9 = "java/applet/Applet" ascii //weight: 2
        $x_2_10 = "java/net/URLClassLoader" ascii //weight: 2
        $x_10_11 = {2a b3 b2 c7 12 b8 59 b3 a7}  //weight: 10, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Trojan_Java_CVE_2010_4465_A_2147659891_0
{
    meta:
        author = "defender2yara"
        detection_name = "Trojan:Java/CVE-2010-4465.A!ldr"
        threat_id = "2147659891"
        type = "Trojan"
        platform = "Java: Java binaries (classes)"
        family = "CVE-2010-4465"
        severity = "Critical"
        info = "ldr: loader component of a malware"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "36"
        strings_accuracy = "High"
    strings:
        $x_5_1 = "java/security/cert/Certificate" ascii //weight: 5
        $x_5_2 = "java/security/Permissions" ascii //weight: 5
        $x_5_3 = "java/security/ProtectionDomain" ascii //weight: 5
        $x_5_4 = "java/security/AllPermission" ascii //weight: 5
        $x_2_5 = "net/URL" ascii //weight: 2
        $x_2_6 = "newInstance" ascii //weight: 2
        $x_2_7 = "getResourceAsStream" ascii //weight: 2
        $x_10_8 = {b7 03 bd b7 19 b7 b6 3a 2a b6 12}  //weight: 10, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Trojan_Java_CVE_2010_4465_A_2147659891_1
{
    meta:
        author = "defender2yara"
        detection_name = "Trojan:Java/CVE-2010-4465.A!ldr"
        threat_id = "2147659891"
        type = "Trojan"
        platform = "Java: Java binaries (classes)"
        family = "CVE-2010-4465"
        severity = "Critical"
        info = "ldr: loader component of a malware"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "42"
        strings_accuracy = "High"
    strings:
        $x_5_1 = "java/io/FileOutputStream" ascii //weight: 5
        $x_5_2 = "java/io/InputStream" ascii //weight: 5
        $x_5_3 = "java/lang/String" ascii //weight: 5
        $x_5_4 = "java/lang/System" ascii //weight: 5
        $x_5_5 = "java/applet/Applet" ascii //weight: 5
        $x_5_6 = "java/net/URL" ascii //weight: 5
        $x_2_7 = "openConnection" ascii //weight: 2
        $x_2_8 = ".tmp" ascii //weight: 2
        $x_2_9 = "getRuntime" ascii //weight: 2
        $x_2_10 = "/pl$Loader" ascii //weight: 2
        $x_6_11 = {19 19 b6 59 36 9e 2c 19 03 15 b6 15 15 60 36 a7}  //weight: 6, accuracy: High
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_6_*) and 6 of ($x_5_*) and 3 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule Trojan_Java_CVE_2010_4465_A_2147659892_0
{
    meta:
        author = "defender2yara"
        detection_name = "Trojan:Java/CVE-2010-4465.A!dec"
        threat_id = "2147659892"
        type = "Trojan"
        platform = "Java: Java binaries (classes)"
        family = "CVE-2010-4465"
        severity = "Critical"
        info = "dec: an internal category used to refer to some threats"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "34"
        strings_accuracy = "Low"
    strings:
        $x_2_1 = "doPrivileged" ascii //weight: 2
        $x_2_2 = "java.io.tmpdir" ascii //weight: 2
        $x_2_3 = "java/lang/Runtime" ascii //weight: 2
        $x_2_4 = "java/io/FileOutputStream" ascii //weight: 2
        $x_2_5 = "java/lang/SecurityManager" ascii //weight: 2
        $x_2_6 = "java/security/AccessController" ascii //weight: 2
        $x_2_7 = "java/security/PrivilegedExceptionAction" ascii //weight: 2
        $x_10_8 = {07 bc 4e 2d 03 ?? 4f 2d 04 ?? 4f 2d 05 ?? 4f 2d 06 ?? 4f 05 36 11 bc 3a}  //weight: 10, accuracy: Low
        $x_10_9 = {15 15 a2 19 15 5c 33 2d 15 07 70 2e 82 91 54 84 84 a7}  //weight: 10, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

