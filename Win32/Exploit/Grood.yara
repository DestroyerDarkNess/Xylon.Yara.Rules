rule Exploit_Win32_Grood_A_2147718033_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Win32/Grood.A!!Grood.A"
        threat_id = "2147718033"
        type = "Exploit"
        platform = "Win32: Windows 32-bit platform"
        family = "Grood"
        severity = "Critical"
        info = "Grood: an internal category used to refer to some threats"
        info = "A: an internal category used to refer to some threats"
        signature_type = "SIGNATURE_TYPE_ARHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "keybd_event" ascii //weight: 1
        $x_1_2 = {0d 00 00 00 40 50 6a f0}  //weight: 1, accuracy: High
        $x_1_3 = {6a 00 6a 00 6a 00 6a 12 ff d6 6a 00 6a 00 6a 00 6a 1b ff d6 6a 00 6a 02 6a 00 6a 1b ff d6 6a 00 6a 02 6a 00 6a 12 ff d6}  //weight: 1, accuracy: High
        $x_1_4 = {6b 65 79 62 64 5f 65 76 65 6e 74 00}  //weight: 1, accuracy: High
        $x_1_5 = {83 c0 03 13 cb 8d 78 d8}  //weight: 1, accuracy: High
        $x_1_6 = {98 12 00 00 98 12 00 00 05 13 00 00 3a 13 00 00 d9 13 00 00 0d 14 00 00 71 14 00 00 71 14 00 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (5 of ($x*))
}

